{% extends 'base.html' %}
{% block title %}Salespeople{% endblock %}

{% block content %}
  <div class="flex items-center justify-between mb-6">
    <h1 class="text-3xl font-bold">Salespeople</h1>

    <div class="flex gap-2">
      <a href="{{ url_for('salespeople.index') }}"
         class="px-3 py-2 rounded-md border text-sm
                {% if not show or show != 'archived' %}bg-white{% else %}bg-gray-100{% endif %}">
        Active
      </a>
      <a href="{{ url_for('salespeople.index', show='archived') }}"
         class="px-3 py-2 rounded-md border text-sm
                {% if show == 'archived' %}bg-white{% else %}bg-gray-100{% endif %}">
        Archived
      </a>
    </div>
  </div>

  <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6">
    {% for sp in salespeople %}
      <div class="bg-white border rounded-xl shadow-sm overflow-hidden flex flex-col">
        {% if sp.photo_url %}
          <img src="{{ sp.photo_url }}" alt="{{ sp.name }}"
               class="h-48 w-full object-cover" loading="lazy" decoding="async"
               onerror="this.style.display='none'">
        {% endif %}

        <div class="p-4 flex flex-col gap-2">
          <div class="flex items-center gap-2">
            <h3 class="font-semibold text-lg">{{ sp.name }}</h3>
            {% if sp.is_active is defined and not sp.is_active %}
              <span class="text-xs px-2 py-0.5 rounded bg-amber-100 text-amber-700">Archived</span>
            {% endif %}
          </div>
          <p class="text-sm text-gray-600">{{ sp.email }}</p>
          {% if sp.phone %}<p class="text-sm text-gray-600">{{ sp.phone }}</p>{% endif %}

          <div class="mt-3 flex gap-2">
            <a href="{{ url_for('salespeople.details', sp_id=sp.id) }}"
               class="px-2.5 py-1 text-sm rounded-md border border-brand text-brand hover:bg-brand hover:text-white">
              Details
            </a>

            {% if sp.is_active %}
              <form action="{{ url_for('salespeople.delete', sp_id=sp.id) }}" method="post"
                    onsubmit="return confirm('Archive {{ sp.name }}?');">
                <button type="submit"
                        class="px-2.5 py-1 text-sm rounded-md border border-red-300 text-red-600 hover:bg-red-50">
                  Archive
                </button>
              </form>
            {% else %}
              <form action="{{ url_for('salespeople.restore', sp_id=sp.id) }}" method="post"
                    onsubmit="return confirm('Restore {{ sp.name }}?');">
                <button type="submit"
                        class="px-2.5 py-1 text-sm rounded-md border border-emerald-300 text-emerald-700 hover:bg-emerald-50">
                  Restore
                </button>
              </form>
            {% endif %}
          </div>
        </div>
      </div>
    {% else %}
      <div class="col-span-full text-center text-gray-500 py-12">
        No salespeople found.
      </div>
    {% endfor %}
  </div>
{% endblock %}
